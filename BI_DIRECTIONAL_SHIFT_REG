module bi_directional_reg(d,clk,dir,reset,q);
input d,clk,reset,dir;
parameter n=4;
output reg [n-1:0]q;
always@(posedge clk or reset)
begin
if(reset==1)
begin
q=0;
end
else
case(dir)
0 :  q <= {q[n-2:0], d};  
1 :  q <= {d, q[n-1:1]};
endcase
end
endmodule
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
TESTBENCH
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
module bi_directional_shiftreg_tb();
reg d,clk,reset,dir;
wire [3:0]q;
bi_directional_reg dut(d,clk,dir,reset,q);
begin
always #5 clk=~clk;
end
initial
begin
clk=0;reset=1;
#10 reset=0;
d <= 4'h1; 
#100 dir =1;
#100 dir =0;
#100 $finish;
end
endmodule
